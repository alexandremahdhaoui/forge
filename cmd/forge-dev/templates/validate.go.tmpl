// Code generated by forge-dev. DO NOT EDIT.
// Source: spec.openapi.yaml
{{.ChecksumHeader}}

package {{.PackageName}}

import (
	"github.com/alexandremahdhaoui/forge/pkg/mcptypes"
)

// Validate validates a Spec and returns validation results.
// It checks required fields and validates enum values.
func Validate(s *Spec) *mcptypes.ConfigValidateOutput {
	if s == nil {
		return &mcptypes.ConfigValidateOutput{
			Valid: true,
		}
	}

	var errors []mcptypes.ValidationError
{{range .Properties}}
{{- if .Required}}
{{- if eq .GoType "string"}}
	// Validate required field: {{.Name}}
	if s.{{.Name | camel}} == "" {
		errors = append(errors, mcptypes.ValidationError{
			Field:   "spec.{{.Name}}",
			Message: "required field is missing",
		})
	}
{{- else if eq .GoType "[]string"}}
	// Validate required field: {{.Name}}
	if len(s.{{.Name | camel}}) == 0 {
		errors = append(errors, mcptypes.ValidationError{
			Field:   "spec.{{.Name}}",
			Message: "required field is missing or empty",
		})
	}
{{- else if eq .GoType "map[string]string"}}
	// Validate required field: {{.Name}}
	if len(s.{{.Name | camel}}) == 0 {
		errors = append(errors, mcptypes.ValidationError{
			Field:   "spec.{{.Name}}",
			Message: "required field is missing or empty",
		})
	}
{{- end}}
{{- end}}
{{- if .Enum}}
	// Validate enum field: {{.Name}}
	if s.{{.Name | camel}} != "" {
		validValues := []string{ {{- range $i, $v := .Enum}}{{if $i}}, {{end}}"{{$v}}"{{end -}} }
		valid := false
		for _, v := range validValues {
			if s.{{.Name | camel}} == v {
				valid = true
				break
			}
		}
		if !valid {
			errors = append(errors, mcptypes.ValidationError{
				Field:   "spec.{{.Name}}",
				Message: "must be one of: {{range $i, $v := .Enum}}{{if $i}}, {{end}}{{$v}}{{end}}",
			})
		}
	}
{{- end}}
{{- end}}

	if len(errors) > 0 {
		return &mcptypes.ConfigValidateOutput{
			Valid:  false,
			Errors: errors,
		}
	}

	return &mcptypes.ConfigValidateOutput{
		Valid: true,
	}
}

// ValidateMap validates a map[string]interface{} by first parsing it to a Spec.
// This is a convenience function for validating spec data from forge.yaml.
func ValidateMap(m map[string]interface{}) *mcptypes.ConfigValidateOutput {
	s, err := FromMap(m)
	if err != nil {
		return &mcptypes.ConfigValidateOutput{
			Valid: false,
			Errors: []mcptypes.ValidationError{
				{
					Field:   "spec",
					Message: err.Error(),
				},
			},
		}
	}

	return Validate(s)
}
